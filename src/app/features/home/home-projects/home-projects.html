<section class="container mx-auto px-5 lg:px-20 py-20 min-h-[800px] section-pattern section-pattern-left">
  <!-- Skeleton Loader -->
  @if (isLoading()) {
    <div class="flex justify-start mb-20 min-h-[60px]">
      <p-skeleton width="200px" height="40px" styleClass="rounded-lg"></p-skeleton>
    </div>

    <!-- Desktop Skeleton -->
    <div class="hidden lg:flex flex-col gap-10 relative min-h-[80vh] pt-30 lg:mx-30 my-10">
      @for (i of [1,2,3]; track i) {
        <div class="absolute flex justify-between items-center rounded-3xl p-8 px-10 min-h-[300px] w-full">
          <p-skeleton width="25%" height="300px" styleClass="rounded-lg"></p-skeleton>
          <div class="w-3/4 flex flex-col gap-4">
            <p-skeleton width="60%" height="30px" styleClass="rounded-lg"></p-skeleton>
            <p-skeleton width="80%" height="40px" styleClass="rounded-lg"></p-skeleton>
            <p-skeleton width="100%" height="100px" styleClass="rounded-lg"></p-skeleton>
            <p-skeleton width="200px" height="30px" styleClass="rounded-lg"></p-skeleton>
          </div>
        </div>
      }
    </div>

    <!-- Mobile Skeleton -->
    <div class="flex lg:hidden flex-col gap-6 my-10 min-h-[600px]">
      @for (i of [1,2,3]; track i) {
        <div class="flex flex-col md:flex-row justify-between items-center rounded-3xl p-6 bg-white shadow-lg min-h-[200px]">
          <p-skeleton width="200px" height="200px" styleClass="rounded-lg"></p-skeleton>
          <div class="w-full md:w-3/4 p-4 flex flex-col gap-4">
            <p-skeleton width="60%" height="24px" styleClass="rounded-lg"></p-skeleton>
            <p-skeleton width="80%" height="28px" styleClass="rounded-lg"></p-skeleton>
            <p-skeleton width="100%" height="80px" styleClass="rounded-lg"></p-skeleton>
            <p-skeleton width="180px" height="24px" styleClass="rounded-lg"></p-skeleton>
          </div>
        </div>
      }
    </div>

    <div class="flex justify-center mt-20">
      <p-skeleton width="200px" height="50px" styleClass="rounded-full"></p-skeleton>
    </div>
  } @else {
    <app-section-title [title]="projectsTitle" customClass="flex justify-start mb-20 min-h-[60px]">
    </app-section-title>
        <!-- Desktop: Cards with animations stacked -->
        <div class="hidden lg:flex flex-col gap-10 relative min-h-[80vh] pt-30 lg:mx-30 my-10">
            @for (project of projects.slice(0, 3); track project.slug; let i = $index) {
                <div #projectCard 
                     class="project-card absolute flex justify-between items-center rounded-3xl p-8 px-10 transition-all duration-300 cursor-pointer min-h-[300px]"
                     [class]="i === 0 ? '-rotate-4 -translate-y-20 bg-gray-200' : i === 1 ? 'active-card bg-white shadow-lg' : 'rotate-4 translate-y-20 bg-gray-100'"
                     (click)="onCardClick(i)">
                    <div class="w-1/4 p-5 xl:p-10 min-h-[300px] min-w-[200px]">
                        <img [ngSrc]="getResponsiveImage(project.image) || '/images/placeholder.png'" [alt]="project.title || ''" width="300" height="300" class="w-[300px] h-[300px] xl:w-[200px] xl:h-[200px] object-cover">
                    </div>
                    <div class="h-full w-3/4 p-5 xl:p-10 min-h-[300px]">
                        <h2 class="text-xl text-[#636363] font-medium mb-6">{{ project.category_name }}</h2>
                        <h3 class="text-xl font-bold text-[#440000] mb-6">{{ project.title }}</h3>
                        <p class="mb-12 text-lg font-medium text-[#440000]">{{ project.text }}</p>
                        <span class="underline text-[#ED2924] font-semibold text-xl flex items-center justify-center">عرض تفاصيل
                            المشروع
                            <img ngSrc="images/icons/arrow-left.png" alt="arrow-left" width="32" height="32" class="mx-1 w-8! ">
                        </span>
                    </div>
                </div>
            }
        </div>

        <!-- Mobile: Cards stacked normally -->
        <div class="flex lg:hidden flex-col gap-6 my-10 min-h-[600px]">
            @for (project of projects.slice(0, 3); track project.slug; let i = $index) {
                <div class="project-card-mobile flex flex-col md:flex-row justify-between items-center rounded-3xl p-6 bg-white shadow-lg min-h-[200px]">
                    <div class="w-full md:w-1/4 p-4 flex justify-center min-h-[200px] min-w-[200px]">
                        <img [ngSrc]="getResponsiveImage(project.image) || '/images/placeholder.png'" [alt]="project.title || ''" width="300" height="300" class="w-full max-w-[200px] md:max-w-[250px] h-[200px] object-cover">
                    </div>
                    <div class="w-full md:w-3/4 p-4 min-h-[200px]">
                        <h2 class="text-lg md:text-xl text-[#636363] font-medium mb-4">{{ project.category_name }}</h2>
                        <h3 class="text-lg md:text-xl font-bold text-[#440000] mb-4">{{ project.title }}</h3>
                        <p class="mb-6 text-base md:text-lg font-medium text-[#440000] line-clamp-3">{{ project.text }}</p>
                        <span class="underline text-[#ED2924] font-semibold text-lg flex items-center justify-center md:justify-start">عرض تفاصيل
                            المشروع
                            <img ngSrc="images/icons/arrow-left.png" alt="arrow-left" width="32" height="32" class="mx-1 w-6 h-6">
                        </span>
                    </div>
                </div>
            }
        </div>
    <!-- } -->

    <div class="flex justify-center ">
        <app-app-button [btnText]="btnText"
            customClass="mt-20! ps-7 pe-3 py-4 bg-[#ED2924] text-white rounded-full flex items-center justify-center  transition duration-300">
        </app-app-button>
    </div>
  }
</section>